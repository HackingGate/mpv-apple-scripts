#!/bin/sh
set -e

PREFIX="${COMMON_OPTIONS%% *}"
PREFIX="${PREFIX##*=}"

UCHARDET_OPTIONS="\
-DCMAKE_INSTALL_PREFIX=$PREFIX \
-DCMAKE_OSX_ARCHITECTURES=$ARCH \
-DCMAKE_OSX_SYSROOT=$SDKPATH \
-DCMAKE_BUILD_TYPE=Release \
-DCMAKE_C_COMPILER_WORKS=TRUE \
-DCMAKE_CXX_COMPILER_WORKS=TRUE \
-DBUILD_STATIC=FALSE \
-DBUILD_BINARY=FALSE \
-DCMAKE_VERBOSE_MAKEFILE=TRUE"

echo "${PWD}"
echo "cmake $SRC/uchardet*"
cmake "$SRC/uchardet*"
echo "cmake $SRC/uchardet* $UCHARDET_OPTIONS"
cmake "$SRC/uchardet*" $UCHARDET_OPTIONS && make
make install -v
